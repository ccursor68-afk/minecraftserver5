'use client'\n\nimport { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport { useRouter, usePathname } from 'next/navigation'\nimport { Gamepad2, LayoutDashboard, Server, Users, Ticket, FileText, Image, LogOut } from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { createBrowserSupabaseClient } from '@/lib/supabase'\nimport { toast } from 'sonner'\n\nexport default function AdminLayout({ children }) {\n  const router = useRouter()\n  const pathname = usePathname()\n  const [user, setUser] = useState(null)\n  const [userRole, setUserRole] = useState(null)\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    checkAuth()\n  }, [])\n\n  const checkAuth = async () => {\n    try {\n      const supabase = createBrowserSupabaseClient()\n      const { data: { user } } = await supabase.auth.getUser()\n      \n      if (!user) {\n        toast.error('Giri\u015f yapmal\u0131s\u0131n\u0131z')\n        router.push('/auth/login')\n        return\n      }\n      \n      // Check if admin\n      const response = await fetch(`/api/auth/user/${user.id}`)\n      if (response.ok) {\n        const userData = await response.json()\n        if (userData.role !== 'admin') {\n          toast.error('Yetkisiz eri\u015fim')\n          router.push('/')\n          return\n        }\n        setUserRole(userData.role)\n      }\n      \n      setUser(user)\n    } catch (error) {\n      console.error('Auth error:', error)\n      router.push('/auth/login')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleSignOut = async () => {\n    const supabase = createBrowserSupabaseClient()\n    await supabase.auth.signOut()\n    router.push('/')\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-b from-[#0a0a0a] via-[#0f0f0f] to-[#0a0a0a] flex items-center justify-center\">\n        <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-4 border-gray-700 border-t-yellow-500\"></div>\n      </div>\n    )\n  }\n\n  if (!user || userRole !== 'admin') {\n    return null\n  }\n\n  const navItems = [\n    { href: '/admin', label: 'Dashboard', icon: LayoutDashboard },\n    { href: '/admin/servers', label: 'Sunucular', icon: Server },\n    { href: '/admin/users', label: 'Kullan\u0131c\u0131lar', icon: Users },\n    { href: '/admin/tickets', label: 'Destek', icon: Ticket },\n    { href: '/admin/blog', label: 'Blog', icon: FileText },\n    { href: '/admin/banners', label: 'Banner', icon: Image },\n  ]\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-[#0a0a0a] via-[#0f0f0f] to-[#0a0a0a]\">\n      {/* Sidebar */}\n      <aside className=\"fixed left-0 top-0 h-full w-64 bg-[#0a0a0a] border-r border-gray-800 z-50\">\n        <div className=\"p-4\">\n          <Link href=\"/\" className=\"flex items-center gap-2 mb-8\">\n            <Gamepad2 className=\"w-8 h-8 text-yellow-500\" />\n            <div>\n              <h1 className=\"text-xl font-bold text-yellow-500\">ADMIN PANEL</h1>\n              <p className=\"text-xs text-gray-400\">Y\u00f6netim Paneli</p>\n            </div>\n          </Link>\n\n          <nav className=\"space-y-2\">\n            {navItems.map((item) => {\n              const Icon = item.icon\n              const isActive = pathname === item.href\n              return (\n                <Link key={item.href} href={item.href}>\n                  <Button\n                    variant={isActive ? 'default' : 'ghost'}\n                    className={`w-full justify-start ${\n                      isActive\n                        ? 'bg-yellow-600 hover:bg-yellow-700 text-white'\n                        : 'text-gray-400 hover:text-white hover:bg-gray-800'\n                    }`}\n                  >\n                    <Icon className=\"w-4 h-4 mr-2\" />\n                    {item.label}\n                  </Button>\n                </Link>\n              )\n            })}\n          </nav>\n\n          <div className=\"absolute bottom-4 left-4 right-4\">\n            <Button\n              onClick={handleSignOut}\n              variant=\"outline\"\n              className=\"w-full border-gray-700 hover:border-red-500 hover:text-red-500\"\n            >\n              <LogOut className=\"w-4 h-4 mr-2\" />\n              \u00c7\u0131k\u0131\u015f Yap\n            </Button>\n          </div>\n        </div>\n      </aside>\n\n      {/* Main Content */}\n      <main className=\"ml-64 min-h-screen\">\n        <div className=\"p-8\">\n          {children}\n        </div>\n      </main>\n    </div>\n  )\n}\n