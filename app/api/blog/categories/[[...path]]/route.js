import { NextResponse } from 'next/server'\nimport { supabase } from '../../../../../lib/supabase.js'\n\nexport async function GET(request) {\n  const { pathname } = new URL(request.url)\n  \n  const slugMatch = pathname.match(/^\\/api\\/blog\\/categories\\/([^\\/]+)$/)\n  if (slugMatch) {\n    const slug = slugMatch[1]\n    \n    try {\n      const { data, error } = await supabase\n        .from('blog_categories')\n        .select('*')\n        .eq('slug', slug)\n        .single()\n      \n      if (error) {\n        return NextResponse.json({ error: 'Category not found' }, { status: 404 })\n      }\n      \n      return NextResponse.json(data)\n    } catch (error) {\n      return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n    }\n  }\n  \n  try {\n    const { data, error } = await supabase\n      .from('blog_categories')\n      .select('*')\n      .eq('isActive', true)\n      .order('position', { ascending: true })\n    \n    if (error) {\n      return NextResponse.json({ error: 'Failed to fetch categories' }, { status: 500 })\n    }\n    \n    return NextResponse.json(data || [])\n  } catch (error) {\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n\nexport async function POST(request) {\n  try {\n    const body = await request.json()\n    \n    if (!body.name || !body.slug) {\n      return NextResponse.json({ error: 'Missing required fields' }, { status: 400 })\n    }\n    \n    const categoryId = `cat_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\n    \n    const { data, error } = await supabase\n      .from('blog_categories')\n      .insert([{\n        id: categoryId,\n        name: body.name,\n        slug: body.slug,\n        description: body.description || null,\n        icon: body.icon || 'üìÅ',\n        color: body.color || '#22c55e',\n        parentId: body.parentId || null,\n        position: body.position || 0,\n        isActive: true,\n        topicCount: 0,\n        postCount: 0,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString()\n      }])\n      .select()\n      .single()\n    \n    if (error) {\n      return NextResponse.json({ error: 'Failed to create category' }, { status: 500 })\n    }\n    \n    return NextResponse.json(data, { status: 201 })\n  } catch (error) {\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}
